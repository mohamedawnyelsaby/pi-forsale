<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pi Debug Mode</title>
    
    <!-- ØªØ­Ù…ÙŠÙ„ Ù…ÙƒØªØ¨Ø© Pi -->
    <script src="https://sdk.minepi.com/pi-sdk.js"></script>

    <style>
        body { background-color: #0a1128; color: white; font-family: sans-serif; text-align: center; padding: 20px; }
        .btn { 
            background: #F8B62C; color: black; font-size: 18px; 
            padding: 15px 30px; border: none; border-radius: 8px; 
            width: 100%; margin-top: 20px; cursor: pointer; font-weight: bold;
        }
        #error-log { 
            color: #ff5252; margin-top: 20px; font-size: 14px; 
            border: 1px solid red; padding: 10px; display: none; text-align: left;
        }
        #success-log {
            color: #2ecc71; margin-top: 20px; font-size: 16px; display: none;
        }
    </style>
</head>
<body>

    <h1>ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ø§ØªØµØ§Ù„</h1>
    <p>Ø§Ø¶ØºØ· Ø£Ø¯Ù†Ø§Ù‡ Ù„Ø§Ø®ØªØ¨Ø§Ø± Pi Network</p>

    <!-- Ø²Ø±Ø§Ø± Ø¨Ø³ÙŠØ· ÙˆÙ…Ø¨Ø§Ø´Ø± -->
    <button class="btn" onclick="startLogin()">ğŸš€ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¢Ù†</button>

    <!-- Ù…ÙƒØ§Ù† Ø¸Ù‡ÙˆØ± Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ (Ø¹Ø´Ø§Ù† Ù†Ø¹Ø±Ù Ø§Ù„Ø³Ø¨Ø¨) -->
    <div id="success-log"></div>
    <div id="error-log"></div>

    <script>
        // 1. ØªÙ‡ÙŠØ¦Ø© Pi SDK
        try {
            Pi.init({ version: "2.0", sandbox: true });
        } catch (err) {
            document.getElementById('error-log').style.display = 'block';
            document.getElementById('error-log').innerHTML = "Ø®Ø·Ø£ ÙÙŠ ØªÙ‡ÙŠØ¦Ø© Pi: " + err;
        }

        // 2. Ø¯Ø§Ù„Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„
        async function startLogin() {
            const errDiv = document.getElementById('error-log');
            const succDiv = document.getElementById('success-log');
            
            // ØªØµÙÙŠØ± Ø§Ù„Ø±Ø³Ø§Ø¦Ù„
            errDiv.style.display = 'none';
            errDiv.innerText = '';
            succDiv.style.display = 'none';

            try {
                // Ø¥Ø¸Ù‡Ø§Ø± ØªÙ†Ø¨ÙŠÙ‡ Ø¥Ù† Ø§Ù„Ø²Ø±Ø§Ø± Ø§ØªØ¯Ø§Ø³
                alert("Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ Pi... Ù„Ùˆ Ø´ÙˆÙØª Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø¯ÙŠ ÙŠØ¨Ù‚Ù‰ Ø§Ù„Ø²Ø±Ø§Ø± Ø´ØºØ§Ù„.");

                // Ø·Ù„Ø¨ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª
                const scopes = ['username', 'payments'];
                const auth = await Pi.authenticate(scopes, onIncomplete);

                // Ù„Ùˆ Ù†Ø¬Ø­
                succDiv.style.display = 'block';
                succDiv.innerHTML = `âœ… ØªÙ… Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­!<br>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: <b>${auth.user.username}</b><br>Token: ${auth.accessToken.substring(0, 10)}...`;
                alert("Ù†Ø¬Ø­ Ø§Ù„Ø¯Ø®ÙˆÙ„!");

            } catch (error) {
                // Ù„Ùˆ ÙØ´Ù„ ÙŠØ¸Ù‡Ø± Ø§Ù„Ø³Ø¨Ø¨
                errDiv.style.display = 'block';
                errDiv.innerText = "âŒ Ø­Ø¯Ø« Ø®Ø·Ø£: " + JSON.stringify(error || "Unknown Error");
                alert("ÙØ´Ù„: " + error);
            }
        }

        function onIncomplete(payment) { console.log(payment); }
    </script>
</body>
</html>
